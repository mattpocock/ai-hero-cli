[
  {
    "command": "cherry-pick",
    "category": "user-flow",
    "description": "User interactively selects and cherry-picks a lesson",
    "tested": true,
    "steps": [
      "User runs `ai-hero cherry-pick` without arguments",
      "System fetches latest commits from upstream",
      "User sees searchable autocomplete with available lessons",
      "User types to filter lessons by ID or message",
      "User selects a lesson (e.g., '01.02.03 Add new feature')",
      "System displays: 'Cherry-picking <sha> onto current branch...'",
      "System applies the commit to current branch",
      "System displays: '✓ Successfully cherry-picked lesson 01.02.03'"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "user-flow",
    "description": "User cherry-picks a specific lesson by ID",
    "tested": true,
    "steps": [
      "User runs `ai-hero cherry-pick 01.02.03`",
      "System fetches latest commits from upstream",
      "System finds commit matching lesson ID",
      "System displays: 'Cherry-picking <sha> onto current branch...'",
      "System applies the commit to current branch",
      "System displays: '✓ Successfully cherry-picked lesson 01.02.03'"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "user-flow",
    "description": "User is prompted to create branch when on main",
    "tested": true,
    "steps": [
      "User is on 'main' branch",
      "User runs `ai-hero cherry-pick 01.02.03`",
      "System displays: 'You cannot cherry-pick onto the main branch.'",
      "System prompts: 'Enter name of your new working branch:'",
      "User enters branch name (e.g., 'matt/feature-work')",
      "System creates and switches to new branch",
      "System displays: '✓ Created and switched to matt/feature-work'",
      "System proceeds with cherry-pick on new branch"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "user-flow",
    "description": "User cancels lesson selection",
    "tested": true,
    "steps": [
      "User runs `ai-hero cherry-pick`",
      "User sees lesson selection prompt",
      "User presses Ctrl+C to cancel",
      "System exits gracefully with no error message",
      "Exit code is 0"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "user-flow",
    "description": "User cherry-picks from custom source branch",
    "tested": false,
    "steps": [
      "User runs `ai-hero cherry-pick --branch custom-lessons`",
      "System fetches 'custom-lessons' branch from upstream",
      "User sees lessons from that branch",
      "User selects a lesson",
      "System cherry-picks from the custom branch"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "error",
    "description": "User runs cherry-pick outside git repo",
    "tested": true,
    "steps": [
      "User is in directory without .git folder",
      "User runs `ai-hero cherry-pick`",
      "System displays: 'Error: Current directory is not a git repository: <path>'",
      "Exit code is 1"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "error",
    "description": "User runs cherry-pick without valid upstream",
    "tested": true,
    "steps": [
      "User has no upstream remote configured",
      "User runs `ai-hero cherry-pick`",
      "System displays: 'Error: No valid upstream remote found.'",
      "System shows instructions to add upstream remote",
      "Exit code is 1"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "error",
    "description": "User requests non-existent lesson",
    "tested": true,
    "steps": [
      "User runs `ai-hero cherry-pick 99.99.99`",
      "System fetches upstream branch",
      "System cannot find matching lesson",
      "System displays: 'Error: No commit found for lesson 99.99.99 on branch live-run-through'",
      "Exit code is 1"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "error",
    "description": "User attempts cherry-pick from same branch",
    "tested": true,
    "steps": [
      "User is on 'live-run-through' branch",
      "User runs `ai-hero cherry-pick`",
      "System displays: 'Error: Cannot cherry-pick when on target branch \"live-run-through\"'",
      "Exit code is 1"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "error",
    "description": "Cherry-pick results in merge conflict",
    "tested": true,
    "steps": [
      "User has conflicting changes on current branch",
      "User runs `ai-hero cherry-pick 01.02.03`",
      "System attempts to apply commit",
      "Git encounters merge conflict",
      "System displays: 'Error: Cherry-pick conflict on range <sha>'",
      "Exit code is 1"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "error",
    "description": "Branch creation fails during main protection flow",
    "tested": false,
    "steps": [
      "User is on 'main' branch",
      "User runs `ai-hero cherry-pick 01.02.03`",
      "User is prompted for branch name",
      "User enters name of branch that already exists",
      "System displays: 'Error: Failed to create branch <name> (exit code: <code>)'",
      "Exit code is 1"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "behavior",
    "description": "Already-applied lessons are excluded from selection",
    "tested": true,
    "steps": [
      "User has already cherry-picked lesson 01.01.01 to current branch",
      "User runs `ai-hero cherry-pick`",
      "User sees lesson list",
      "Lesson 01.01.01 is NOT shown in the list",
      "User can only select lessons not yet applied"
    ]
  },
  {
    "command": "cherry-pick",
    "category": "behavior",
    "description": "Multiple commits with same lesson ID uses latest",
    "tested": true,
    "steps": [
      "Target branch has two commits with lesson ID 01.01.01",
      "User runs `ai-hero cherry-pick 01.01.01`",
      "System selects the latest (most recent) commit with that ID",
      "System cherry-picks that commit"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User interactively resets to solution state",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset`",
      "System fetches latest commits from upstream",
      "User sees searchable autocomplete with available lessons",
      "User selects a lesson",
      "System displays: 'Found commit: <sha> <message>'",
      "User is prompted: 'Start the exercise or view final code?'",
      "User selects 'Final code'",
      "User is prompted: 'How would you like to proceed?'",
      "User selects 'Reset current branch'",
      "System displays: 'Resetting to <commit> (final code)...'",
      "System displays: '✓ Reset to lesson <id> (final code)'"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User resets to problem state (before solution)",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset`",
      "User selects a lesson",
      "User is prompted: 'Start the exercise or view final code?'",
      "User selects 'Start the exercise'",
      "System resets to the parent commit of the lesson",
      "System displays: '✓ Reset to lesson <id> (problem state)'"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User resets to solution using --solution flag",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset 01.02.03 --solution`",
      "System skips state selection prompt",
      "User is prompted for action (reset or create branch)",
      "User selects action",
      "System resets to solution commit"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User resets to problem using --problem flag",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset 01.02.03 --problem`",
      "System skips state selection prompt",
      "System uses parent commit of lesson",
      "User is prompted for action",
      "System resets to problem state"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User creates new branch from lesson",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset 01.02.03`",
      "User selects state (problem or solution)",
      "User is prompted: 'How would you like to proceed?'",
      "User selects 'Create new branch from commit'",
      "User is prompted: 'Enter new branch name:'",
      "User enters 'matt/lesson-work'",
      "System displays: 'Creating branch matt/lesson-work from <commit> (<state>)...'",
      "System displays: '✓ Created and checked out branch: matt/lesson-work'"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User is forced to create branch when on main",
    "tested": true,
    "steps": [
      "User is on 'main' branch",
      "User runs `ai-hero reset 01.02.03`",
      "User selects state",
      "System displays: 'You cannot reset the main branch. Creating a new branch...'",
      "System skips action selection prompt",
      "User is prompted for branch name",
      "System creates new branch at target commit"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User is warned about uncommitted changes",
    "tested": true,
    "steps": [
      "User has uncommitted changes in working directory",
      "User runs `ai-hero reset 01.02.03`",
      "User selects state and 'Reset current branch'",
      "System displays: 'Warning: You have uncommitted changes:'",
      "System shows git status output",
      "User is prompted: 'This will lose all uncommitted work. Continue?'",
      "Default answer is NO",
      "User confirms YES",
      "System performs hard reset"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User cancels reset due to uncommitted changes",
    "tested": true,
    "steps": [
      "User has uncommitted changes",
      "User runs `ai-hero reset 01.02.03`",
      "User selects 'Reset current branch'",
      "System warns about uncommitted changes",
      "User is prompted to confirm",
      "User selects NO (default)",
      "System displays: 'Reset cancelled'",
      "No changes are made to the repository"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User runs reset in demo mode",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset 01.02.03 --demo`",
      "System skips state selection (uses solution)",
      "System skips action selection (uses reset-current)",
      "System displays: 'Resetting to <commit> (final code)...'",
      "System performs hard reset to commit",
      "System displays: 'Undoing commit and unstaging changes...'",
      "System soft resets HEAD^ (undo commit)",
      "System unstages all changes",
      "System displays: '✓ Demo mode: Reset to lesson <id> with unstaged changes'",
      "Files are in working directory, nothing staged or committed"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User cancels lesson selection",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset`",
      "User sees lesson selection prompt",
      "User presses Ctrl+C",
      "System exits gracefully with no error message",
      "Exit code is 0"
    ]
  },
  {
    "command": "reset",
    "category": "error",
    "description": "User runs reset outside git repo",
    "tested": true,
    "steps": [
      "User is in directory without .git folder",
      "User runs `ai-hero reset`",
      "System displays: 'Error: Current directory is not a git repository: <path>'",
      "Exit code is 1"
    ]
  },
  {
    "command": "reset",
    "category": "error",
    "description": "User runs reset without valid upstream",
    "tested": true,
    "steps": [
      "User has no upstream remote configured",
      "User runs `ai-hero reset`",
      "System displays: 'Error: No valid upstream remote found.'",
      "System shows instructions to add upstream remote",
      "Exit code is 1"
    ]
  },
  {
    "command": "reset",
    "category": "error",
    "description": "User requests non-existent lesson",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset 99.99.99`",
      "System fetches upstream branch",
      "System cannot find matching lesson",
      "System displays: 'Error: No commit found for lesson 99.99.99 on branch live-run-through'",
      "Exit code is 1"
    ]
  },
  {
    "command": "reset",
    "category": "error",
    "description": "User requests problem state for root commit",
    "tested": false,
    "steps": [
      "First lesson commit is the initial commit (no parent)",
      "User runs `ai-hero reset 01.01.01 --problem`",
      "System tries to get parent commit",
      "System displays: 'Error: Commit <sha> has no parent commit. Repository may be in an invalid state.'",
      "Exit code is 1"
    ]
  },
  {
    "command": "reset",
    "category": "error",
    "description": "User provides conflicting state flags",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset --problem --solution`",
      "System displays: 'Error: Cannot use both --problem and --solution flags'",
      "Exit code is 1"
    ]
  },
  {
    "command": "reset",
    "category": "error",
    "description": "User uses --demo with state flags",
    "tested": true,
    "steps": [
      "User runs `ai-hero reset --demo --problem`",
      "System displays: 'Error: Cannot use --demo with --problem or --solution flags'",
      "Exit code is 1"
    ]
  },
  {
    "command": "reset",
    "category": "error",
    "description": "User attempts reset when on target branch",
    "tested": true,
    "steps": [
      "User is on 'live-run-through' branch",
      "User runs `ai-hero reset 01.02.03`",
      "User selects state and 'Reset current branch'",
      "System displays: 'Error: Cannot reset current branch when on target branch \"live-run-through\"'",
      "Exit code is 1"
    ]
  },
  {
    "command": "reset",
    "category": "error",
    "description": "User tries to create branch that exists",
    "tested": false,
    "steps": [
      "User runs `ai-hero reset 01.02.03`",
      "User selects 'Create new branch'",
      "User enters name of existing branch",
      "System displays: 'Error: Failed to create branch <name>'",
      "Exit code is 1"
    ]
  },
  {
    "command": "reset",
    "category": "behavior",
    "description": "Lesson IDs are normalized to standard format",
    "tested": false,
    "steps": [
      "User runs `ai-hero reset 1.1.1`",
      "System normalizes to '01.01.01'",
      "System finds matching commit",
      "Reset proceeds normally"
    ]
  },
  {
    "command": "reset",
    "category": "user-flow",
    "description": "User resets from custom source branch",
    "tested": false,
    "steps": [
      "User runs `ai-hero reset --branch custom-lessons`",
      "System fetches 'custom-lessons' branch from upstream",
      "User sees lessons from that branch",
      "User selects lesson and state",
      "System resets from the custom branch"
    ]
  }
]
