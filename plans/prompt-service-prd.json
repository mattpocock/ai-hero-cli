[
  {
    "service": "PromptService",
    "method": "confirmReadyToCommit",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts user to confirm ready to commit changes",
    "steps": [
      "Method displays: 'Ready to commit?'",
      "Default is true (yes)",
      "Returns void on confirmation",
      "Throws PromptCancelledError if user says no or presses Ctrl+C"
    ]
  },
  {
    "service": "PromptService",
    "method": "confirmSaveToTargetBranch",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts user to confirm saving to target branch",
    "steps": [
      "Method receives target branch name as parameter",
      "Displays: 'Save changes to <branch>?'",
      "Default is true (yes)",
      "Returns void on confirmation",
      "Throws PromptCancelledError if user declines or cancels"
    ]
  },
  {
    "service": "PromptService",
    "method": "confirmForcePush",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts user to confirm force push (dangerous operation)",
    "steps": [
      "Method receives branch name as parameter",
      "Displays: 'Force push to origin/<branch>?'",
      "Default is false (no) for safety",
      "Returns void on confirmation",
      "Throws PromptCancelledError if user declines or cancels"
    ]
  },
  {
    "service": "PromptService",
    "method": "selectCherryPickConflictAction",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts user to select action during cherry-pick conflict",
    "steps": [
      "Displays select prompt with 3 options",
      "Option 1: 'Continue' - proceed after resolving conflicts",
      "Option 2: 'Abort' - cancel the cherry-pick",
      "Option 3: 'Skip' - skip this commit",
      "Returns 'continue' | 'abort' | 'skip'",
      "Throws PromptCancelledError if user presses Ctrl+C"
    ]
  },
  {
    "service": "PromptService",
    "method": "selectProblemOrSolution",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts user to select problem or solution state for reset",
    "steps": [
      "Displays select prompt with 2 options",
      "Option 1: 'Start the exercise' - resets to problem state (parent commit)",
      "Option 2: 'View final code' - resets to solution state (lesson commit)",
      "Returns 'problem' | 'solution'",
      "Throws PromptCancelledError on cancel"
    ]
  },
  {
    "service": "PromptService",
    "method": "selectResetAction",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts user to choose reset method",
    "steps": [
      "Method receives current branch name for display",
      "Displays: 'How would you like to proceed?'",
      "Option 1: 'Reset current branch' - hard reset current branch",
      "Option 2: 'Create new branch from commit' - create new branch at target",
      "Returns 'reset-current' | 'create-branch'",
      "Throws PromptCancelledError on cancel"
    ]
  },
  {
    "service": "PromptService",
    "method": "confirmResetWithUncommittedChanges",
    "category": "behavior",
    "status": "DONE",
    "description": "Warns about uncommitted changes before reset",
    "steps": [
      "Displays: 'This will lose all uncommitted work. Continue?'",
      "Default is false (no) for safety",
      "Returns void on confirmation",
      "Throws PromptCancelledError if user declines or cancels"
    ]
  },
  {
    "service": "PromptService",
    "method": "inputBranchName",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts user to enter a new branch name",
    "steps": [
      "Method receives context: 'working' or 'new'",
      "If 'working': displays 'Enter name of your new working branch:'",
      "If 'new': displays 'Enter new branch name:'",
      "Returns the entered string",
      "Throws PromptCancelledError if user presses Ctrl+C"
    ]
  },
  {
    "service": "PromptService",
    "method": "selectLessonCommit",
    "category": "behavior",
    "status": "DONE",
    "description": "Autocomplete prompt for selecting a lesson commit",
    "steps": [
      "Method receives array of commits with lessonId and message",
      "Method receives custom prompt message",
      "Displays autocomplete with format: '<lessonId> <message>'",
      "User can type to filter by lesson ID (e.g., '01.02.03') or message text",
      "Uses regex-based fuzzy matching for lesson IDs",
      "Returns the selected lesson ID string",
      "Throws PromptCancelledError on cancel"
    ]
  },
  {
    "service": "PromptService",
    "method": "selectExercise",
    "category": "behavior",
    "status": "DONE",
    "description": "Autocomplete prompt for selecting an exercise",
    "steps": [
      "Method receives array of lessons with num, name, and path",
      "Method receives custom prompt message",
      "Displays autocomplete with lesson options",
      "User can type to filter by lesson number or name",
      "Uses normalizeExerciseNumber for fuzzy matching",
      "Returns the selected lesson number (index)",
      "Throws PromptCancelledError on cancel"
    ]
  },
  {
    "service": "PromptService",
    "method": "confirmProceedWithUncommittedChanges",
    "category": "behavior",
    "status": "DONE",
    "description": "Warns about uncommitted changes in walk-through",
    "steps": [
      "Displays: 'You have uncommitted changes. Continuing will lose them. Proceed?'",
      "Default is false (no) for safety",
      "Returns void on confirmation",
      "Throws PromptCancelledError if user declines or cancels"
    ]
  },
  {
    "service": "PromptService",
    "method": "selectWalkThroughAction",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts for next action during walk-through",
    "steps": [
      "Method receives current commit number and total commits",
      "Displays: 'Commit <N>/<Total> applied. Next?'",
      "Option 1: 'Continue to next commit'",
      "Option 2: 'Cancel walk-through'",
      "Returns 'continue' | 'cancel'",
      "Throws PromptCancelledError on Ctrl+C"
    ]
  },
  {
    "service": "PromptService",
    "method": "selectExerciseAction",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts for next action after running exercise",
    "steps": [
      "Method receives result status, hasNext, hasPrevious, labels, lessonType",
      "Dynamically builds choices based on context",
      "Always shows: 'Run again', 'Choose different exercise', 'Finish'",
      "Shows 'Next' only if hasNext is true, with nextLabel",
      "Shows 'Previous' only if hasPrevious is true, with previousLabel",
      "Uses emoji indicators: checkmark for success, X for failed",
      "Returns selected action string",
      "Throws PromptCancelledError on cancel"
    ]
  },
  {
    "service": "PromptService",
    "method": "selectSubfolder",
    "category": "behavior",
    "status": "DONE",
    "description": "Prompts user to select a subfolder for exercise",
    "steps": [
      "Method receives array of subfolder names",
      "Displays autocomplete with subfolder options",
      "Returns the selected index (0-based)",
      "Throws PromptCancelledError on cancel"
    ]
  },
  {
    "service": "PromptService",
    "method": "*",
    "category": "error",
    "description": "User cancels any prompt with Ctrl+C",
    "steps": [
      "User presses Ctrl+C during any prompt",
      "Prompts library returns empty object {}",
      "Service detects empty result",
      "Throws PromptCancelledError",
      "Calling code handles error appropriately"
    ]
  },
  {
    "service": "PromptService",
    "method": "*",
    "category": "testing",
    "description": "Mocking PromptService in command tests",
    "steps": [
      "Create mock layer with Layer.succeed(PromptService, {...})",
      "Override specific methods to return test values",
      "Override methods to throw PromptCancelledError for cancel tests",
      "Provide mock layer via Effect.provide()",
      "Test command behavior with controlled prompt responses"
    ]
  },
  {
    "service": "PromptService",
    "method": "*",
    "category": "migration",
    "description": "Migrating a file from runPrompt to PromptService",
    "steps": [
      "Add import: import { PromptService } from './prompt-service.js'",
      "In Effect.gen, add: const promptService = yield* PromptService",
      "Replace runPrompt<{ field: Type }>(() => prompt([...])) with promptService.methodName()",
      "Remove destructuring - methods return values directly",
      "For confirms that check result: method throws on decline, so remove if(!result) checks",
      "Run tests to verify behavior unchanged"
    ]
  },
  {
    "service": "PromptService",
    "method": "*",
    "category": "migration-tracking",
    "status": "IN_PROGRESS",
    "description": "Track files migrated from runPrompt to PromptService",
    "migratedFiles": [
      "src/internal/edit-commit.ts",
      "src/reset.ts",
      "src/internal/walk-through.ts",
      "src/exercise.ts"
    ],
    "remainingFiles": [
      "src/cherry-pick.ts",
      "src/commit-utils.ts"
    ]
  }
]
